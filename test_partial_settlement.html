<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨åˆ†éŠ·å¸³æ¸¬è©¦</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="bi bi-bug me-2"></i>éƒ¨åˆ†éŠ·å¸³é‚è¼¯æ¸¬è©¦</h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h6><i class="bi bi-info-circle me-2"></i>æ¸¬è©¦å ´æ™¯</h6>
                            <p>å¾…ä»˜é‡‘é¡: NT$ 22,500.00</p>
                            <p>éŠ·å¸³é‡‘é¡: NT$ 10,000.00</p>
                            <p>é æœŸçµæœ: æ‡‰è©²å…è¨±éƒ¨åˆ†éŠ·å¸³ï¼ˆ10000 < 22500ï¼‰</p>
                        </div>

                        <div class="mb-4">
                            <h5>æ¸¬è©¦ 1: åŸºæœ¬æ¯”è¼ƒé‚è¼¯</h5>
                            <button class="btn btn-primary" onclick="testBasicComparison()">æ¸¬è©¦åŸºæœ¬æ¯”è¼ƒ</button>
                            <div id="result1" class="mt-2 text-muted"></div>
                        </div>

                        <div class="mb-4">
                            <h5>æ¸¬è©¦ 2: æ•¸å­—è§£æé‚è¼¯</h5>
                            <button class="btn btn-primary" onclick="testNumberParsing()">æ¸¬è©¦æ•¸å­—è§£æ</button>
                            <div id="result2" class="mt-2 text-muted"></div>
                        </div>

                        <div class="mb-4">
                            <h5>æ¸¬è©¦ 3: æ¨¡æ“¬éŠ·å¸³é©—è­‰</h5>
                            <button class="btn btn-primary" onclick="testSettlementValidation()">æ¸¬è©¦éŠ·å¸³é©—è­‰</button>
                            <div id="result3" class="mt-2 text-muted"></div>
                        </div>

                        <div class="mb-4">
                            <h5>æ¸¬è©¦ 4: å¯¦éš›è¼¸å…¥æ¡†æ¸¬è©¦</h5>
                            <div class="mb-3">
                                <label for="testInput" class="form-label">éŠ·å¸³é‡‘é¡ (TWD)</label>
                                <input type="text" class="form-control" id="testInput" value="10000" pattern="[0-9]*\.?[0-9]*">
                            </div>
                            <button class="btn btn-primary" onclick="testActualInput()">æ¸¬è©¦å¯¦éš›è¼¸å…¥</button>
                            <div id="result4" class="mt-2 text-muted"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ•¸å­—æ ¼å¼åŒ–è…³æœ¬ -->
    <script src="static/js/enhanced_number_input.js"></script>
    
    <script>
        // æ¸¬è©¦åŸºæœ¬æ¯”è¼ƒé‚è¼¯
        function testBasicComparison() {
            const originalAmount = 22500;
            const settlementAmount = 10000;
            
            const result = settlementAmount > originalAmount;
            
            document.getElementById('result1').innerHTML = `
                <div class="alert ${result ? 'alert-danger' : 'alert-success'}">
                    <strong>æ¯”è¼ƒçµæœ:</strong><br>
                    éŠ·å¸³é‡‘é¡: ${settlementAmount}<br>
                    å¾…ä»˜é‡‘é¡: ${originalAmount}<br>
                    ${settlementAmount} > ${originalAmount} = ${result}<br>
                    <strong>${result ? 'âŒ éŒ¯èª¤ï¼šéŠ·å¸³é‡‘é¡è¶…éå¾…ä»˜é‡‘é¡' : 'âœ… æ­£ç¢ºï¼šå…è¨±éƒ¨åˆ†éŠ·å¸³'}</strong>
                </div>
            `;
        }

        // æ¸¬è©¦æ•¸å­—è§£æé‚è¼¯
        function testNumberParsing() {
            const testValues = ['10000', '10000.00', '10,000', '10,000.00', '10000.0'];
            let results = [];
            
            testValues.forEach(value => {
                // æ¨¡æ“¬ getActualValue æ–¹æ³•
                const rawValue = value.replace(/[^0-9.-]/g, '');
                const parsed = parseFloat(rawValue);
                results.push(`${value} â†’ ${parsed}`);
            });
            
            document.getElementById('result2').innerHTML = `
                <div class="alert alert-info">
                    <strong>æ•¸å­—è§£ææ¸¬è©¦:</strong><br>
                    ${results.join('<br>')}
                </div>
            `;
        }

        // æ¸¬è©¦éŠ·å¸³é©—è­‰é‚è¼¯
        function testSettlementValidation() {
            const originalAmount = 22500;
            const settlementAmount = 10000;
            
            console.log('ğŸ” éŠ·å¸³é©—è­‰æ¸¬è©¦:', {
                originalAmount,
                settlementAmount,
                isGreater: settlementAmount > originalAmount
            });
            
            let validationResult = '';
            let isValid = true;
            
            if (!settlementAmount || settlementAmount <= 0 || isNaN(settlementAmount)) {
                validationResult = 'âŒ éŠ·å¸³é‡‘é¡é©—è­‰å¤±æ•—';
                isValid = false;
            } else if (settlementAmount > originalAmount) {
                validationResult = 'âŒ éŠ·å¸³é‡‘é¡è¶…éå¾…ä»˜é‡‘é¡';
                isValid = false;
            } else {
                validationResult = 'âœ… éŠ·å¸³é‡‘é¡é©—è­‰é€šé';
                isValid = true;
            }
            
            document.getElementById('result3').innerHTML = `
                <div class="alert ${isValid ? 'alert-success' : 'alert-danger'}">
                    <strong>éŠ·å¸³é©—è­‰çµæœ:</strong><br>
                    åŸå§‹é‡‘é¡: ${originalAmount}<br>
                    éŠ·å¸³é‡‘é¡: ${settlementAmount}<br>
                    <strong>${validationResult}</strong>
                </div>
            `;
        }

        // æ¸¬è©¦å¯¦éš›è¼¸å…¥æ¡†
        function testActualInput() {
            const input = document.getElementById('testInput');
            const originalAmount = 22500;
            
            // æ¨¡æ“¬å¯¦éš›çš„æ•¸å­—è§£æé‚è¼¯
            let settlementAmount;
            
            if (input.getActualValue) {
                settlementAmount = parseFloat(input.getActualValue());
            } else {
                const rawValue = input.value.replace(/[^0-9.-]/g, '');
                settlementAmount = parseFloat(rawValue);
            }
            
            console.log('ğŸ” å¯¦éš›è¼¸å…¥æ¸¬è©¦:', {
                inputValue: input.value,
                settlementAmount,
                originalAmount,
                isGreater: settlementAmount > originalAmount
            });
            
            let validationResult = '';
            let isValid = true;
            
            if (!settlementAmount || settlementAmount <= 0 || isNaN(settlementAmount)) {
                validationResult = 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„éŠ·å¸³é‡‘é¡';
                isValid = false;
            } else if (settlementAmount > originalAmount) {
                validationResult = 'âŒ éŠ·å¸³é‡‘é¡ä¸èƒ½è¶…éå¾…ä»˜é‡‘é¡';
                isValid = false;
            } else {
                validationResult = 'âœ… éŠ·å¸³é‡‘é¡é©—è­‰é€šéï¼Œå…è¨±éƒ¨åˆ†éŠ·å¸³';
                isValid = true;
            }
            
            document.getElementById('result4').innerHTML = `
                <div class="alert ${isValid ? 'alert-success' : 'alert-danger'}">
                    <strong>å¯¦éš›è¼¸å…¥æ¸¬è©¦çµæœ:</strong><br>
                    è¼¸å…¥å€¼: "${input.value}"<br>
                    è§£æå€¼: ${settlementAmount}<br>
                    å¾…ä»˜é‡‘é¡: ${originalAmount}<br>
                    <strong>${validationResult}</strong>
                </div>
            `;
        }

        // åˆå§‹åŒ–æ•¸å­—æ ¼å¼åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            const input = document.getElementById('testInput');
            if (input && typeof setupNumberInputFormatting === 'function') {
                setupNumberInputFormatting(input, { maxDecimals: 2 });
                console.log('âœ… æ¸¬è©¦è¼¸å…¥æ¡†æ•¸å­—æ ¼å¼åŒ–å·²æ‡‰ç”¨');
            }
        });
    </script>
</body>
</html>




